(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[776],{92951:function(e,t,i){Promise.resolve().then(i.bind(i,46154))},46154:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return k}});var n=i(57437),l=i(78833),a=i(20798),r=i(44900),s=i(98902),o=i(73890),c=i(213),d=i(7893),u=i(2265),x=i(25790),h=i(15268),p=i(63993),j=i(79225);async function g(e){return await (0,j.U)("shortLink/list",e)}async function y(e){return await (0,j.U)("project/idTitle",e)}async function m(e){return await (0,j.v)("shortLink/add",e)}async function v(e){return await (0,j.v)("shortLink/update",e)}async function f(e){return await (0,j.v)("shortLink/remove",e)}var S=e=>{let[t,i]=(0,u.useState)(!1),[l,a]=(0,u.useState)(!1),[r,s]=(0,u.useState)(),[o,d]=(0,u.useState)(e.values),[x,j]=(0,u.useState)([]),g=()=>{i(!0)};return(0,u.useEffect)(()=>{(async()=>{let e=await y({});e&&0===e.code&&(console.log(e.data.map(e=>({label:e.title,value:e.id}))),j(e.data))})()},[]),(0,n.jsxs)(n.Fragment,{children:[(null==o?void 0:o.id)?(0,n.jsx)(c.zx,{onClick:g,type:"secondary",icon:(0,n.jsx)(h.Z,{}),"aria-label":"编辑"}):(0,n.jsx)(c.zx,{onClick:g,theme:"outline",type:"primary",icon:(0,n.jsx)(p.Z,{}),children:"添加短链"}),(0,n.jsx)(c.u_,{title:"编辑短链",keepDOM:!0,visible:t,onOk:()=>{null==r||r.validate().then(async n=>{let l;a(!0),l=o&&o.id?await v(n):await m(n),a(!1),0===l.code?(await e.refresh(),i(!t)):c.FN.error(l.msg)}).catch(e=>{console.log(e)})},okButtonProps:{loading:l},style:{width:600},onCancel:()=>{i(!1)},children:(0,n.jsxs)(c.l0,{getFormApi:e=>{s(e)},labelPosition:"left",initValues:o,children:[(0,n.jsx)(c.l0.Input,{field:"title",initValue:o?o.title:"",label:"标题"}),(0,n.jsxs)(c.l0.Select,{initValue:o?o.project_id:"-1",field:"project_id",label:"广告",children:[(0,n.jsx)(c.l0.Select.Option,{value:"-1",children:"--请选择--"}),x.map(e=>(0,n.jsx)(c.l0.Select.Option,{value:e.id,children:e.title},e.id))]}),(0,n.jsxs)(c.l0.Select,{initValue:o?""+o.status:"-1",field:"status",label:{text:"状态",optional:!1},children:[(0,n.jsx)(c.l0.Select.Option,{value:"-1",children:"--请选择--"}),(0,n.jsx)(c.l0.Select.Option,{value:"0",children:"待投放"}),(0,n.jsx)(c.l0.Select.Option,{value:"1",children:"已投放"})]}),(0,n.jsx)(c.l0.TextArea,{field:"remark",initValue:o?o.remark:"",label:"备注"})]})})]})},b=i(57171),k=()=>{let[e,t]=(0,u.useState)(""),[i,h]=(0,u.useState)({}),p=[{title:"标题",dataIndex:"title",render:(e,t)=>"".concat(t.title),onFilter:(e,t)=>t.title.includes(e)},{title:"广告标题",dataIndex:"project_title",render:(e,t)=>{var i;return"".concat(null==t?void 0:null===(i=t.project)||void 0===i?void 0:i.title)}},{title:"短链",dataIndex:"url",render:e=>(0,n.jsx)("a",{target:"_blank",href:e,children:e})},{title:"备注",dataIndex:"remark",render:e=>(0,n.jsx)("a",{target:"_blank",href:e,children:e})},{title:"状态",dataIndex:"status",render:e=>{let t={1:{color:"pink",prefixIcon:(0,n.jsx)(l.Z,{}),text:"已投放"},0:{color:"cyan",prefixIcon:(0,n.jsx)(a.Z,{}),text:"待投放"}}[e]||{};return(0,n.jsx)(c.Vp,{shape:"circle",...t,style:{userSelect:"text"},children:t.text})}},{title:"所有者",dataIndex:"name",render:(e,t,i)=>{var l;return(0,n.jsx)(c.T,{children:(0,n.jsx)(c.qE,{size:"small",color:"red",style:{marginRight:4},children:(null==t?void 0:null===(l=t.user)||void 0===l?void 0:l.name)||"-"})})}},{title:"更新日期",dataIndex:"updated_at",sorter:(e,t)=>e.updateTime-t.updateTime>0?1:-1,render:e=>d.Z(new Date(e),"yyyy-MM-dd")},{title:"创建日期",dataIndex:"created_at",sorter:(e,t)=>e.updateTime-t.updateTime>0?1:-1,render:e=>d.Z(new Date(e),"yyyy-MM-dd")},{title:"操作",width:170,dataIndex:"id",render:(e,t)=>(0,n.jsxs)(c.T,{children:[(0,n.jsx)(S,{values:t,refresh:()=>C(_)}),(0,n.jsx)(c.gn,{title:"确认删除吗？",onConfirm:async()=>await L(e),position:"leftBottom",children:(0,n.jsx)("div",{children:(0,n.jsx)(c.zx,{type:"danger",icon:(0,n.jsx)(r.Z,{}),"aria-label":"删除"})})}),(0,n.jsx)(c.zx,{onClick:()=>{c.u_.success({title:"企微获客二维码",content:(0,n.jsx)(b.Qd,{size:200,style:{margin:"auto"},value:t.project.qiwei_link+"?customer_channel="+e})})},type:"secondary",icon:(0,n.jsx)(s.Z,{}),"aria-label":"企微二维码"}),(0,n.jsx)(c.zx,{onClick:()=>{var e,i,l;let a="<div>\n    <img src='"+t.url+"?type=0' width=0 height=0 />\n    <a target='_blank' href='"+t.url+"?type=1'>"+(null==t?void 0:null===(e=t.project)||void 0===e?void 0:e.title)+"</a>\n</div>",r=(0,n.jsxs)("div",{children:[(0,n.jsx)("img",{src:t.url,width:0,height:0}),(0,n.jsx)("a",{target:"_blank",style:{textDecoration:"underline",color:"#0000FF"},href:t.url+"?type=1",children:null==t?void 0:null===(i=t.project)||void 0===i?void 0:i.title})]}),s=(0,n.jsxs)("div",{children:[(0,n.jsx)("img",{src:t.url,width:0,height:0}),(0,n.jsx)("a",{target:"_blank",style:{textDecoration:"underline",color:"#0000FF"},href:t.url+"?type=2",children:null==t?void 0:null===(l=t.project)||void 0===l?void 0:l.title})]});c.u_.success({width:800,title:"广告代码",content:(0,n.jsxs)("div",{children:[(0,n.jsx)(c.Kx,{defaultValue:a}),(0,n.jsx)(c.iz,{style:{margin:"12px 0"}}),r,(0,n.jsx)(c.jL,{style:{margin:"12px 0"},type:"info",description:"默认广告链接会进入对应广告配置的地址，如果想直接进入企业微信二维码界面，请将<a>标签内的type改为2即可，效果如下：",closeIcon:null}),s]})})},type:"secondary",icon:(0,n.jsx)(o.Z,{}),"aria-label":"广告代码"})]})}],j=async e=>await g(e),[y,m]=(0,u.useState)([]),[v,k]=(0,u.useState)(!1),[_,w]=(0,u.useState)(1),[z,I]=(0,u.useState)(0),Z=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;k(!0),w(t),k(!1);let i=await j({page:t,title:e});I(i.total),m(i.data)},C=e=>{Z(e)},L=async e=>{let t=await f({id:e});0===t.code?(c.FN.success(t.msg),C(_)):c.FN.error(t.msg)};return(0,u.useEffect)(()=>{Z()},[]),(0,n.jsxs)(x.Z,{children:[(0,n.jsx)("div",{style:{textAlign:"right",paddingBottom:"12px"},children:(0,n.jsx)(S,{values:void 0,refresh:()=>C(_)})}),(0,n.jsx)(c.iA,{columns:p,dataSource:y,pagination:{currentPage:_,pageSize:10,total:z,onPageChange:C},loading:v})]})}},25790:function(e,t,i){"use strict";i.d(t,{Z:function(){return k}});var n=i(57437),l=i(213),a=i(2265),r=i(16463),s=i(79225),o=i(1342),c=()=>{let{Footer:e}=l.Layout;return(0,n.jsx)(e,{style:{display:"flex",justifyContent:"space-between",padding:"20px",color:"var(--semi-color-text-2)",backgroundColor:"rgba(var(--semi-grey-0), 1)"},children:(0,n.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(o.Z,{size:"large",style:{marginRight:"8px"}}),(0,n.jsx)("span",{children:"Copyright \xa9 2024 壹择科技. All Rights Reserved. "})]})})},d=i(37006),u=i(24408),x=e=>{var t;let{Header:i}=l.Layout;return(0,n.jsx)(i,{style:{backgroundColor:"var(--semi-color-bg-1)"},children:(0,n.jsx)(l.JL,{mode:"horizontal",footer:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.zx,{theme:"borderless",icon:(0,n.jsx)(d.Z,{size:"large"}),style:{color:"var(--semi-color-text-2)",marginRight:"12px"}}),(0,n.jsx)(l.zx,{theme:"borderless",icon:(0,n.jsx)(u.Z,{size:"large"}),style:{color:"var(--semi-color-text-2)",marginRight:"12px"}}),(0,n.jsx)(l.qE,{color:"orange",size:"small",children:null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.name})]})})})},h=i(62509),p=i(17863),j=i(7931),g=i(49256),y=i(73600),m=i(20211),v=i(42132),f=i(47775),S=i(20357),b=e=>{let{Sider:t}=l.Layout,i=(0,r.useRouter)(),s=(0,r.usePathname)(),[o,c]=(0,a.useState)(s.substring(1)||"Home");return(0,n.jsx)(t,{style:{backgroundColor:"rgb(242, 242, 244)"},children:(0,n.jsx)(l.JL,{defaultSelectedKeys:[o],selectedKeys:[o],style:{maxWidth:220,height:"100%",backgroundColor:"var(--color-fill-0)"},items:[{itemKey:"Home",text:"首页",icon:(0,n.jsx)(h.Z,{size:"large"})},{itemKey:"Data",text:"基础数据",icon:(0,n.jsx)(p.Z,{size:"large"})},{itemKey:"Project",text:"广告管理",icon:(0,n.jsx)(j.Z,{size:"large"})},{itemKey:"Custom",text:"客户管理",icon:(0,n.jsx)(g.Z,{size:"large"})},{itemKey:"ShortLink",text:"短链管理",icon:(0,n.jsx)(y.Z,{size:"large"})},{itemKey:"Account",text:"账号管理",icon:(0,n.jsx)(m.Z,{size:"large"})},{itemKey:"Setting",text:"系统设置",icon:(0,n.jsx)(v.Z,{size:"large"})}],header:{logo:(0,n.jsx)(f.Z,{style:{fontSize:36}}),text:S.env.NEXT_PUBLIC_TITLE,style:{paddingBottom:"12px"}},footer:{collapseButton:!0},onSelect:e=>{i.push("/"+e.itemKey)}})})},k=e=>{let{children:t}=e,{Content:i}=l.Layout,o=function(e,t){let[i,n]=(0,a.useState)(null),[l,o]=(0,a.useState)(!1),c=(0,r.useRouter)();return(0,a.useEffect)(()=>{let i=localStorage.getItem("user");i&&n(JSON.parse(i));let a=async()=>{let{data:i,code:a}=await (0,s.U)("user/current",{}),r=!!i;n(0===a?i:null),0===a&&localStorage.setItem("user",JSON.stringify(i)),o(!0),e&&l&&(e&&!t&&!r||t&&r)&&c.push(e)};i||a()},[e,t,l,c]),i}("/Login",!1);return(0,n.jsxs)(l.Layout,{style:{height:"100%"},children:[(0,n.jsx)(b,{user:o}),(0,n.jsxs)(l.Layout,{children:[(0,n.jsx)(x,{user:o}),(0,n.jsx)(i,{style:{padding:"12px",backgroundColor:"#f9f9fa"},children:(0,n.jsx)("div",{style:{borderRadius:"10px",border:"1px solid var(--semi-color-border)",height:"auto",backgroundColor:"var(--semi-color-bg-0)",padding:"24px"},children:t})}),(0,n.jsx)(c,{})]})]})}},79225:function(e,t,i){"use strict";i.d(t,{U:function(){return l},v:function(){return a}});var n=i(213);async function l(e,t){let i="";if(t){for(let e in t)i+="&"+e+"="+t[e];i="?"+i.substring(1)}let l={"Content-Type":"application/json",Accept:"application/json"};localStorage.getItem("access_token")&&(l.Authorization=localStorage.getItem("access_token"));let a=await fetch("https://crm.yizetech.com.cn/api/"+e+i,{method:"GET",headers:l}),r=await a.json();return 429===a.status?n.P_.open({title:"系统通知",content:"频率限制，请稍后再试"}):401===a.status?n.P_.open({title:"系统通知",content:"登录失效"}):200!==a.status&&n.P_.open({title:"系统通知",content:"接口异常"}),r}async function a(e,t){let i={"Content-Type":"application/json",Accept:"application/json"};localStorage.getItem("access_token")&&(i.Authorization=localStorage.getItem("access_token"));let l=await fetch("https://crm.yizetech.com.cn/api/"+e,{method:"POST",headers:i,body:JSON.stringify({...t})}),a=await l.json();return 429===l.status?n.P_.open({title:"系统通知",content:"频率限制，请稍后再试"}):401===l.status?n.P_.open({title:"系统通知",content:"登录失效"}):200!==l.status&&n.P_.open({title:"系统通知",content:"接口异常"}),a}}},function(e){e.O(0,[324,197,971,23,744],function(){return e(e.s=92951)}),_N_E=e.O()}]);