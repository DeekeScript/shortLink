(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[776],{92951:function(e,t,i){Promise.resolve().then(i.bind(i,46154))},46154:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return b}});var n=i(57437),a=i(78833),l=i(20798),s=i(44900),r=i(98902),o=i(21968),c=i(7893),d=i(2265),u=i(25790),x=i(15268),h=i(63993),p=i(79225);async function g(e){return await (0,p.U)("shortLink/list",e)}async function j(e){return await (0,p.U)("project/idTitle",e)}async function y(e){return await (0,p.v)("shortLink/add",e)}async function m(e){return await (0,p.v)("shortLink/update",e)}async function f(e){return await (0,p.v)("shortLink/remove",e)}var v=e=>{let[t,i]=(0,d.useState)(!1),[a,l]=(0,d.useState)(!1),[s,r]=(0,d.useState)(),[c,u]=(0,d.useState)(e.values),[p,g]=(0,d.useState)([]),f=()=>{i(!0)};return(0,d.useEffect)(()=>{(async()=>{let e=await j({});e&&0===e.code&&(console.log(e.data.map(e=>({label:e.title,value:e.id}))),g(e.data))})()},[]),(0,n.jsxs)(n.Fragment,{children:[(null==c?void 0:c.id)?(0,n.jsx)(o.zx,{onClick:f,type:"secondary",icon:(0,n.jsx)(x.Z,{}),"aria-label":"编辑"}):(0,n.jsx)(o.zx,{onClick:f,theme:"outline",type:"primary",icon:(0,n.jsx)(h.Z,{}),children:"添加短链"}),(0,n.jsx)(o.u_,{title:"编辑短链",keepDOM:!0,visible:t,onOk:()=>{null==s||s.validate().then(async n=>{let a;l(!0),a=c&&c.id?await m(n):await y(n),l(!1),0===a.code?(await e.refresh(),i(!t)):o.FN.error(a.msg)}).catch(e=>{console.log(e)})},okButtonProps:{loading:a},style:{width:600},onCancel:()=>{i(!1)},children:(0,n.jsxs)(o.l0,{getFormApi:e=>{r(e)},labelPosition:"left",initValues:c,children:[(0,n.jsx)(o.l0.Input,{field:"title",initValue:c?c.title:"",label:"标题"}),(0,n.jsxs)(o.l0.Select,{initValue:c?c.project_id:"-1",field:"project_id",label:"广告",children:[(0,n.jsx)(o.l0.Select.Option,{value:"-1",children:"--请选择--"}),p.map(e=>(0,n.jsx)(o.l0.Select.Option,{value:e.id,children:e.title},e.id))]}),(0,n.jsxs)(o.l0.Select,{initValue:c?""+c.status:"-1",field:"status",label:{text:"状态",optional:!1},children:[(0,n.jsx)(o.l0.Select.Option,{value:"-1",children:"--请选择--"}),(0,n.jsx)(o.l0.Select.Option,{value:"0",children:"待投放"}),(0,n.jsx)(o.l0.Select.Option,{value:"1",children:"已投放"})]}),(0,n.jsx)(o.l0.TextArea,{field:"remark",initValue:c?c.remark:"",label:"备注"})]})})]})},S=i(57171),b=()=>{let[e,t]=(0,d.useState)(""),[i,x]=(0,d.useState)({}),h=[{title:"标题",dataIndex:"title",render:(e,t)=>"".concat(t.title),onFilter:(e,t)=>t.title.includes(e)},{title:"广告标题",dataIndex:"project_title",render:(e,t)=>{var i;return"".concat(null==t?void 0:null===(i=t.project)||void 0===i?void 0:i.title)}},{title:"短链",dataIndex:"url",render:e=>(0,n.jsx)("a",{target:"_blank",href:e,children:e})},{title:"状态",dataIndex:"status",render:e=>{let t={1:{color:"pink",prefixIcon:(0,n.jsx)(a.Z,{}),text:"已投放"},0:{color:"cyan",prefixIcon:(0,n.jsx)(l.Z,{}),text:"待投放"}}[e]||{};return(0,n.jsx)(o.Vp,{shape:"circle",...t,style:{userSelect:"text"},children:t.text})}},{title:"所有者",dataIndex:"name",render:(e,t,i)=>{var a;return(0,n.jsx)(o.T,{children:(0,n.jsx)(o.qE,{size:"small",color:"red",style:{marginRight:4},children:(null==t?void 0:null===(a=t.user)||void 0===a?void 0:a.name)||"-"})})}},{title:"更新日期",dataIndex:"updated_at",sorter:(e,t)=>e.updateTime-t.updateTime>0?1:-1,render:e=>c.Z(new Date(e),"yyyy-MM-dd")},{title:"创建日期",dataIndex:"created_at",sorter:(e,t)=>e.updateTime-t.updateTime>0?1:-1,render:e=>c.Z(new Date(e),"yyyy-MM-dd")},{title:"操作",width:150,dataIndex:"id",render:(e,t)=>(0,n.jsxs)(o.T,{children:[(0,n.jsx)(v,{values:t,refresh:()=>C(k)}),(0,n.jsx)(o.gn,{title:"确认删除吗？",onConfirm:async()=>await I(e),position:"leftBottom",children:(0,n.jsx)("div",{children:(0,n.jsx)(o.zx,{type:"danger",icon:(0,n.jsx)(s.Z,{}),"aria-label":"删除"})})}),(0,n.jsx)(o.zx,{onClick:()=>{o.u_.success({title:"企微获客二维码",content:(0,n.jsx)(S.Qd,{size:200,style:{margin:"auto"},value:t.project.qiwei_link+"?customer_channel="+e})})},type:"secondary",icon:(0,n.jsx)(r.Z,{}),"aria-label":"企微二维码"})]})}],p=async e=>await g(e),[j,y]=(0,d.useState)([]),[m,b]=(0,d.useState)(!1),[k,w]=(0,d.useState)(1),[z,_]=(0,d.useState)(0),Z=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;b(!0),w(t),b(!1);let i=await p({page:t,title:e});_(i.total),y(i.data)},C=e=>{Z(e)},I=async e=>{let t=await f({id:e});0===t.code?(o.FN.success(t.msg),C(k)):o.FN.error(t.msg)};return(0,d.useEffect)(()=>{Z()},[]),(0,n.jsxs)(u.Z,{children:[(0,n.jsx)("div",{style:{textAlign:"right",paddingBottom:"12px"},children:(0,n.jsx)(v,{values:void 0,refresh:()=>C(k)})}),(0,n.jsx)(o.iA,{columns:h,dataSource:j,pagination:{currentPage:k,pageSize:10,total:z,onPageChange:C},loading:m})]})}},25790:function(e,t,i){"use strict";i.d(t,{Z:function(){return b}});var n=i(57437),a=i(21968),l=i(2265),s=i(16463),r=i(79225),o=i(1342),c=()=>{let{Footer:e}=a.Layout;return(0,n.jsx)(e,{style:{display:"flex",justifyContent:"space-between",padding:"20px",color:"var(--semi-color-text-2)",backgroundColor:"rgba(var(--semi-grey-0), 1)"},children:(0,n.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(o.Z,{size:"large",style:{marginRight:"8px"}}),(0,n.jsx)("span",{children:"Copyright \xa9 2024 壹择科技. All Rights Reserved. "})]})})},d=i(37006),u=i(24408),x=e=>{var t;let{Header:i}=a.Layout;return(0,n.jsx)(i,{style:{backgroundColor:"var(--semi-color-bg-1)"},children:(0,n.jsx)(a.JL,{mode:"horizontal",footer:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.zx,{theme:"borderless",icon:(0,n.jsx)(d.Z,{size:"large"}),style:{color:"var(--semi-color-text-2)",marginRight:"12px"}}),(0,n.jsx)(a.zx,{theme:"borderless",icon:(0,n.jsx)(u.Z,{size:"large"}),style:{color:"var(--semi-color-text-2)",marginRight:"12px"}}),(0,n.jsx)(a.qE,{color:"orange",size:"small",children:null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.name})]})})})},h=i(62509),p=i(17863),g=i(7931),j=i(49256),y=i(73600),m=i(20211),f=i(42132),v=i(47775),S=e=>{let{Sider:t}=a.Layout,i=(0,s.useRouter)(),r=(0,s.usePathname)(),[o,c]=(0,l.useState)(r.substring(1)||"Home");return(0,n.jsx)(t,{style:{backgroundColor:"rgb(242, 242, 244)"},children:(0,n.jsx)(a.JL,{defaultSelectedKeys:[o],selectedKeys:[o],style:{maxWidth:220,height:"100%",backgroundColor:"var(--color-fill-0)"},items:[{itemKey:"Home",text:"首页",icon:(0,n.jsx)(h.Z,{size:"large"})},{itemKey:"Data",text:"基础数据",icon:(0,n.jsx)(p.Z,{size:"large"})},{itemKey:"Project",text:"广告管理",icon:(0,n.jsx)(g.Z,{size:"large"})},{itemKey:"Custom",text:"客户管理",icon:(0,n.jsx)(j.Z,{size:"large"})},{itemKey:"ShortLink",text:"短链管理",icon:(0,n.jsx)(y.Z,{size:"large"})},{itemKey:"Account",text:"账号管理",icon:(0,n.jsx)(m.Z,{size:"large"})},{itemKey:"Setting",text:"系统设置",icon:(0,n.jsx)(f.Z,{size:"large"})}],header:{logo:(0,n.jsx)(v.Z,{style:{fontSize:36}}),text:"壹择短链",style:{paddingBottom:"12px"}},footer:{collapseButton:!0},onSelect:e=>{i.push("/"+e.itemKey)}})})},b=e=>{let{children:t}=e,{Content:i}=a.Layout,o=function(e,t){let[i,n]=(0,l.useState)(null),[a,o]=(0,l.useState)(!1),c=(0,s.useRouter)();return(0,l.useEffect)(()=>{let i=localStorage.getItem("user");i&&n(JSON.parse(i));let l=async()=>{let{data:i,code:l}=await (0,r.U)("user/current",{}),s=!!i;n(0===l?i:null),0===l&&localStorage.setItem("user",JSON.stringify(i)),o(!0),e&&a&&(e&&!t&&!s||t&&s)&&c.push(e)};i||l()},[e,t,a,c]),i}("/Login",!1);return(0,n.jsxs)(a.Layout,{style:{height:"100%"},children:[(0,n.jsx)(S,{user:o}),(0,n.jsxs)(a.Layout,{children:[(0,n.jsx)(x,{user:o}),(0,n.jsx)(i,{style:{padding:"12px",backgroundColor:"#f9f9fa"},children:(0,n.jsx)("div",{style:{borderRadius:"10px",border:"1px solid var(--semi-color-border)",height:"auto",backgroundColor:"var(--semi-color-bg-0)",padding:"24px"},children:t})}),(0,n.jsx)(c,{})]})]})}},79225:function(e,t,i){"use strict";i.d(t,{U:function(){return a},v:function(){return l}});var n=i(21968);async function a(e,t){let i="";if(t){for(let e in t)i+="&"+e+"="+t[e];i="?"+i.substring(1)}let a={"Content-Type":"application/json",Accept:"application/json"};localStorage.getItem("access_token")&&(a.Authorization=localStorage.getItem("access_token"));let l=await fetch("https://crm.yizetech.com.cn/api/"+e+i,{method:"GET",headers:a}),s=await l.json();return 429===l.status?n.P_.open({title:"系统通知",content:"频率限制，请稍后再试"}):200!==l.status&&n.P_.open({title:"系统通知",content:"接口异常"}),s}async function l(e,t){let i={"Content-Type":"application/json",Accept:"application/json"};localStorage.getItem("access_token")&&(i.Authorization=localStorage.getItem("access_token"));let a=await fetch("https://crm.yizetech.com.cn/api/"+e,{method:"POST",headers:i,body:JSON.stringify({...t})}),l=await a.json();return 429===a.status?n.P_.open({title:"系统通知",content:"频率限制，请稍后再试"}):200!==a.status&&n.P_.open({title:"系统通知",content:"接口异常"}),l}}},function(e){e.O(0,[371,876,971,23,744],function(){return e(e.s=92951)}),_N_E=e.O()}]);