(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[650],{69599:function(e,t,i){Promise.resolve().then(i.bind(i,57849))},57849:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return S}});var a=i(57437),n=i(92181),l=i(78833),r=i(20798),s=i(44900),d=i(32902),c=i(7893),o=i(2265),u=i(91751),p=i(15268),x=i(63993),h=i(79225);async function m(e){return await (0,h.U)("project/list",e)}async function w(e){return await (0,h.v)("project/add",e)}async function f(e){return await (0,h.v)("project/update",e)}async function j(e){return await (0,h.v)("project/remove",e)}async function v(e){return await (0,h.U)("qiwei/departmentList",e)}async function g(e){return await (0,h.U)("qiwei/departmentUserList",e)}var y=e=>{let[t,i]=(0,o.useState)(!1),[n,l]=(0,o.useState)(!1),[r,s]=(0,o.useState)(),[c,u]=(0,o.useState)(e.values),[h,m]=(0,o.useState)([]),[j,y]=(0,o.useState)([]),C=()=>{i(!0)},S=async()=>{m((await v({})).data)},_=async e=>{y((await g({department_id:e.department_id})).data)};return(0,o.useEffect)(()=>{t&&(console.log(c),S(),_({department_id:(null==c?void 0:c.qiwei_department_id)||0}))},[t]),(0,a.jsxs)(a.Fragment,{children:[(null==c?void 0:c.id)?(0,a.jsx)(d.zx,{onClick:C,type:"secondary",icon:(0,a.jsx)(p.Z,{}),"aria-label":"编辑"}):(0,a.jsx)(d.zx,{onClick:C,theme:"outline",type:"primary",icon:(0,a.jsx)(x.Z,{}),"aria-label":"添加广告",children:"添加广告"}),(0,a.jsx)(d.u_,{title:"编辑广告",keepDOM:!0,visible:t,onOk:()=>{null==r||r.validate().then(async a=>{let n;l(!0),n=c&&c.id?await f(a):await w(a),l(!1),0===n.code?(await e.refresh(),i(!t)):d.FN.error(n.msg)}).catch(e=>{console.log(e)})},confirmLoading:n,style:{width:600},onCancel:()=>{i(!1)},children:(0,a.jsxs)(d.l0,{getFormApi:e=>{s(e)},labelPosition:"left",initValues:c,children:[(0,a.jsx)(d.l0.Input,{field:"title",label:"广告名称"}),(0,a.jsxs)(d.l0.Select,{initValue:c?""+c.status:"-1",field:"status",label:{text:"广告状态",optional:!1},children:[(0,a.jsx)(d.l0.Select.Option,{value:"-1",children:"--请选择--"}),(0,a.jsx)(d.l0.Select.Option,{value:"0",children:"待上线"}),(0,a.jsx)(d.l0.Select.Option,{value:"1",children:"已上线"}),(0,a.jsx)(d.l0.Select.Option,{value:"2",children:"已完成"})]}),(0,a.jsxs)(d.l0.Select,{onChange:async e=>{_({department_id:e}),null==r||r.setValue("qiwei_userid",[])},field:"qiwei_department_id",initValue:(null==c?void 0:c.qiwei_department_id)||"-1",label:{text:"企微部门",optional:!1},children:[(0,a.jsx)(d.l0.Select.Option,{value:"-1",children:"--请选择--"}),h.map(e=>(0,a.jsx)(d.l0.Select.Option,{value:e.id,children:e.name},"department"+e.id))]}),(0,a.jsx)(d.l0.Select,{multiple:!0,field:"qiwei_userid",initValue:c?c.qiwei_userid:0,label:{text:"对接人",optional:!1},children:j.map(e=>(0,a.jsx)(d.l0.Select.Option,{value:e.userid,children:e.name},"department_user"+e.userid))}),(0,a.jsx)(d.l0.Input,{field:"url",label:"链接地址"})]})})]})},C=i(15578),S=()=>{let[e,t]=(0,o.useState)({}),i=[{title:"标题",dataIndex:"title",search:!0,render:e=>"".concat(e),onFilter:(e,t)=>t.title.includes(e)},{title:"广告地址",width:300,dataIndex:"url",search:!0,render:e=>"".concat(e)},{title:"企微获客链接",width:300,search:!0,dataIndex:"qiwei_link",render:e=>"".concat(e)},{title:"企微对接人",width:120,dataIndex:"qiwei_userid",ellipsis:!0,render:e=>(0,a.jsx)(d.Sx.Text,{ellipsis:{showTooltip:!0},children:e})},{title:"状态",dataIndex:"status",search:!0,type:"select",options:[{label:"待上线",value:0},{label:"已上线",value:1},{label:"已完成",value:2}],render:e=>{let t={2:{color:"green",prefixIcon:(0,a.jsx)(n.Z,{}),text:"已完成"},1:{color:"pink",prefixIcon:(0,a.jsx)(l.Z,{}),text:"已上线"},0:{color:"cyan",prefixIcon:(0,a.jsx)(r.Z,{}),text:"待上线"}}[e]||{};return(0,a.jsx)(d.Vp,{shape:"circle",...t,style:{userSelect:"text"},children:t.text})}},{title:"所有者",dataIndex:"name",render:(e,t,i)=>{var n;return(0,a.jsx)(d.T,{children:(0,a.jsx)(d.qE,{size:"small",color:"red",style:{marginRight:4},children:(null==t?void 0:null===(n=t.user)||void 0===n?void 0:n.name)||"-"})})}},{title:"更新日期",dataIndex:"updated_at",sorter:(e,t)=>e.updateTime-t.updateTime>0?1:-1,render:e=>c.Z(new Date(e),"yyyy-MM-dd")},{title:"创建日期",dataIndex:"created_at",type:"dateRange",search:!0,sorter:(e,t)=>e.updateTime-t.updateTime>0?1:-1,render:e=>c.Z(new Date(e),"yyyy-MM-dd")},{title:"操作",width:100,dataIndex:"id",render:(e,t)=>(0,a.jsxs)(d.T,{children:[(0,a.jsx)(y,{values:t,refresh:()=>Z(v)}),(0,a.jsx)(d.gn,{title:"确认删除吗？",onConfirm:async()=>await I(e),position:"leftBottom",children:(0,a.jsx)("div",{children:(0,a.jsx)(d.zx,{type:"danger",icon:(0,a.jsx)(s.Z,{}),"aria-label":"删除"})})})]})}],p=async e=>await m(e),[x,h]=(0,o.useState)([]),[w,f]=(0,o.useState)(!1),[v,g]=(0,o.useState)(1),[S,_]=(0,o.useState)(0),b=async i=>{f(!0),g(i.page||1),t(e);let a=await p(i);_(a.total),h(a.data),f(!1)},Z=t=>{e.page=t,b(e)},I=async e=>{let t=await j({id:e});0===t.code?(d.FN.success(t.msg),Z(v)):d.FN.error(t.msg)};return(0,o.useEffect)(()=>{b({page:1})},[]),(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(C.Z,{fields:i,onSubmit:e=>{e.page=1,console.log(e),b(e)}}),(0,a.jsx)("div",{style:{textAlign:"right",paddingBottom:"12px"},children:(0,a.jsx)(y,{values:void 0,refresh:()=>Z(v)})}),(0,a.jsx)(d.iA,{columns:i,dataSource:x,pagination:{currentPage:v,pageSize:10,total:S,onPageChange:Z},loading:w})]})}},78833:function(e,t,i){"use strict";var a=i(2265);let n=(0,i(26018).A)(function(e){return a.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),a.createElement("path",{d:"M12 23C18.075 23 23 18.075 23 12C23 5.925 18.075 1 12 1C5.925 1 1 5.925 1 12C1 18.075 5.925 23 12 23ZM19.857 12C19.8568 13.5605 19.392 15.0855 18.5217 16.3808C17.6515 17.676 16.4153 18.6828 14.9706 19.2728C13.526 19.8628 11.9384 20.0093 10.4103 19.6936C8.88208 19.3778 7.48253 18.6142 6.39 17.5L12 12V4.143C14.0838 4.143 16.0823 4.97079 17.5557 6.44426C19.0292 7.91774 19.857 9.91619 19.857 12Z",fill:"currentColor"}))},"duration");t.Z=n},63993:function(e,t,i){"use strict";var a=i(2265);let n=(0,i(26018).A)(function(e){return a.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),a.createElement("path",{d:"M20.5 13.5C21.3284 13.5 22 12.8284 22 12C22 11.1716 21.3284 10.5 20.5 10.5L13.5 10.5L13.5 3.5C13.5 2.67157 12.8284 2 12 2C11.1716 2 10.5 2.67157 10.5 3.5L10.5 10.5L3.5 10.5C2.67157 10.5 2 11.1716 2 12C2 12.8284 2.67157 13.5 3.5 13.5L10.5 13.5V20.5C10.5 21.3284 11.1716 22 12 22C12.8284 22 13.5 21.3284 13.5 20.5V13.5L20.5 13.5Z",fill:"currentColor"}))},"plus");t.Z=n}},function(e){e.O(0,[293,990,804,727,81,971,23,744],function(){return e(e.s=69599)}),_N_E=e.O()}]);